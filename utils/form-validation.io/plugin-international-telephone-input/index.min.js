/** 
 * FormValidation (https://formvalidation.io)
 * The best validation library for JavaScript
 * (c) 2013 - 2023 Nguyen Huu Phuoc <me@phuoc.ng>
 *
 * @license https://formvalidation.io/license
 * @package @form-validation/plugin-international-telephone-input
 * @version 2.1.0
 */

import{Plugin as t}from"../core/index.min.js";var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},e(t,n)};var n=function(t){function n(e){var n=t.call(this,e)||this;return n.intlTelInstances=new Map,n.countryChangeHandler=new Map,n.fieldElements=new Map,n.opts=Object.assign({},{autoPlaceholder:"polite",utilsScript:""},e),n.validatePhoneNumber=n.checkPhoneNumber.bind(n),n.fields="string"==typeof n.opts.field?n.opts.field.split(","):n.opts.field,n}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(n,t),n.prototype.install=function(){var t=this;this.core.registerValidator(n.INT_TEL_VALIDATOR,this.validatePhoneNumber),this.fields.forEach((function(e){var r;t.core.addField(e,{validators:(r={},r[n.INT_TEL_VALIDATOR]={message:t.opts.message},r)});var o=t.core.getElements(e)[0],i=function(){return t.core.revalidateField(e)};o.addEventListener("countrychange",i),t.countryChangeHandler.set(e,i),t.fieldElements.set(e,o),t.intlTelInstances.set(e,intlTelInput(o,t.opts))}))},n.prototype.uninstall=function(){var t=this;this.fields.forEach((function(e){var r=t.countryChangeHandler.get(e),o=t.fieldElements.get(e),i=t.getIntTelInstance(e);r&&o&&i&&(o.removeEventListener("countrychange",r),t.core.disableValidator(e,n.INT_TEL_VALIDATOR),i.destroy())}))},n.prototype.getIntTelInstance=function(t){return this.intlTelInstances.get(t)},n.prototype.checkPhoneNumber=function(){var t=this;return{validate:function(e){var n=e.value,r=t.getIntTelInstance(e.field);return""!==n&&r?{valid:r.isValidNumber()}:{valid:!0}}}},n.INT_TEL_VALIDATOR="___InternationalTelephoneInputValidator",n}(t);export{n as InternationalTelephoneInput};
